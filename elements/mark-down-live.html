<polymer-element name="mark-down-live" attributes="text">
  <template>
    <style>
      #markup, #markdown {
        width: 50%;
        float: left;
      }
      #editor {
        width: 80%;
        height: 250px;
      }
    </style>
    <div id="markup">
      <textarea id="editor">{{text}}</textarea>
    </div>
    <div id="markdown"></div>
  </template>
  <script>
    Polymer("mark-down-live", {
      ready: function() {
        this.text = this.text || "";
        this.rendered = "";
        var that = this;
        this.$.editor.onkeyup = function(ev) {
          that.render();
        }
        this.render();
      },
      render: function() {
        this.text = this.$.editor.value;
        var content = this.trim(this.text);
        var parsed = markdown.toHTML(content);
        this.$.markdown.innerHTML = parsed;
      },
      // Thanks Ryan Seddon! (https://github.com/ryanseddon/markdown-component)
      // Remove all leading/trailing whitespace so it's not confused as
      // a code block
      trim: function(str) {
        var cleaned = str.split('\n').map(function(x) {
          return x.trim();
        }).join('\n');
        return cleaned;
      }
    });
  </script>
</polymer-element>
